<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
	<script type="text/javascript">
	/* 
	Jquery 제공하는 비동기 함수
	https://www.w3schools.com/jquery/jquery_ajax_intro.asp
	https://api.jquery.com/category/ajax/
	
		Ajax
		Global Ajax Event Handlers  (10%)
		Helper Functions (10%)
		Low-Level Interface (30%) 모든 옵션을 개발자가 제어 >> $.ajax()
		Shorthand Methods   (50%) 기본 옵션을 가지고 있는 함수 >>  load() , get() , post()
		
		.load( url [, data ] [, complete ] )
	    Description: Load data from the server and place the returned HTML into the matched elements.
	    
	    url
	    Type: String
	    A string containing the URL to which the request is sent.
	   
	    data
	    Type: PlainObject or String
	    A plain object or string that is sent to the server with the request.
	    
	    
	    complete (서버에서 응답이 오면 readyState == 4번이면 자동호출)
	    Type: Function( String responseText, String textStatus, jqXHR jqXHR )
	    A callback function that is executed when the request completes.
	
	    load 함수
	    1. 서버에서 받는 데이터가 (html , text) 방식
	    2. Client 에서 정의한 특정 요소에 매핑할 목적 ( 자동 innerHTML)
	    
	    data 두번째 parameter  설정
	    jsp?empno=7788
	    		
	    		
	    data 두번째 객체(json)
	    {name:"kglim",age:100}
	    servlet.do?name=kglim&age=100
	    		
	    		
	    complete 함수 (callback)
	    
	*/
	$(function(){
		$('#btn').click(function(){
			//let msg = $('#msg2').val();
			//$('#display').load("Ex01_Server_Date.jsp?msg="+msg);
			$('#display').load("Ex01_Server_Date.jsp",{"msg":$('#msg2').val()},
				function(responseText, textStatus, xhr){
				//자동 콜백함수
				//응답 4번
				// responseText가 text이거나 html 형태일때
				
					if(textStatus == "success"){
						//응답이 와서 readyState == 4 이고 stateCode가 200~299 범위라면(정상응답),
						console.log("responseText : " + responseText);
					} else {
						//응답 readyState ==4 code==500 or code=404
						console.log("response fail : " + xhr.status + "," + xhr.statusText);
					}
				}		
			);
		});
	});
	</script>
</head>
<body>
		<h3>비동기 처리</h3>
		<input type="text" name="msg2" id="msg2">
		<input type="button" id="btn" value="비동기전송">
		<div id="display"></div>
</body>
</html>